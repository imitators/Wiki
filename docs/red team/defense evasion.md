# 防御规避

## 滥用提升控制机制

设置 sid/设置 gid/绕过用户账户控制/sudo 和 sudo 缓存/快速提升执行

## 操纵访问令牌

令牌模拟/令牌盗窃/使用令牌创建流程/制作和模拟令牌/父级 PID 欺骗/SID 历史注入

## BITS 工作

## 反混淆/解码文件信息

## 直接卷访问

## 修改域策略

组策略修改/域信任修改

## 执行护栏

环境键

## 利用防御规避

## 文件和目录权限修改

Windows/Linux/Mac

## 隐藏人工痕迹

隐藏文件和目录/隐藏用户/隐藏窗口/NTFS 文件属性/隐藏文件系统/运行虚拟实例/VBA Stomping

## 劫持执行流程

服务文件权限不足/可执行安全文件权限不足/服务注册中心权限不足/通过未引用路径进行路径拦截/通过 PATH 环境变量进行路径拦截/通过搜索订单劫持进行路径拦截/DLL 搜索顺序劫持/DLL 侧面加载/LD_PRELOAD/Dylib 劫持/COR_PROFILER

## 破坏防御

禁用或修改工具/禁用 Windows 事件记录/破坏历史命令日志/禁用或修改防火墙/阻止指标收集/禁用或修改云防火墙/禁用云日志

## 移除主机指示

清除 Windows 事件日志/清除 Mac 或 Linux 系统日志/清除历史命令/文件删除/删除网络共享连接/Times Stomp

## 间接命令执行

## 伪装

无效代码签名/从右到左覆盖/重命名系统实用程序/伪装任务或服务/匹配合法名称或位置/文件名后空格

## 修改身份验证过程

域控身份验证/密码过滤 DLL/可插拔认证模块/网络设备认证

## 修改云计算机基础架构

创建快照/创建云实例/删除云实例/还原云实例

## 修改注册表

## 修改系统镜像

修补系统镜像/下载系统镜像

## 桥接网络边界

NAT 遍历

## 混淆的文件或信息

二进制填充/软件包装/隐写术/交付后编译/移除工具指示

## 操作系统前启动

系统固件/组件固件/引导工具/ROMMON 工具/TFTP 引导

## 进程注入

DLL 注入/便携式 exe 注入/线程执行劫持/异步过程调用/线程本地存储/Ptrace 系统调用/Proc 内存/EWM 注入/process doppelgänging/进程空心化/VDSO 劫持

## 恶意域控

## 根工具

## 签名的二进制代理执行

Rundll32/编译 HTML 文件/控制面板/CMSTP/InstallUtil/Mshta/Regsvcs/Regasm/Regsvr32/Msiexec/Odbcconf/Verclsid

## 签名的脚本代理执行

PubPrn

## 颠覆信任控制

绕过 Gatekeeper/代码签名/SIP 和信任提供者劫持/安装根证书

## 模板注入

## 流量信号

端口启用

## 可信开发者程序代理执行

MSBuild

## 未使用/不受支持的云区域

## 使用备用身份验证材料

通过哈希/通过票据/应用访问令牌/网络会话 Cookie

## 有效账号

默认账号/域账号/本地账号/云账号

## 虚拟化/沙盒规避

系统检查/基于用户活动的检查/基于时间的规避

## 弱加密

减少键空间/禁用加密硬件

## XSL脚本处理